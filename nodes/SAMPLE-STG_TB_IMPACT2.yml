steps:
  STG_TB_IMPACT2-090daba6-9a5d-4654-af35-90cff8403382:
    operation:
      config:
        insertStrategy: INSERT
        postSQL: ""
        preSQL: ""
        testsEnabled: true
        truncateBefore: true
      database: ""
      deployEnabled: true
      description: ""
      isMultisource: false
      locationName: SAMPLE
      materializationType: view
      metadata:
        appliedNodeTests: []
        columns:
          - columnReference:
              columnCounter: 96344059-c58c-4fe2-b9e7-b984bf0019ab
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALESBYASIN_TOTALORDERITEMS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: c3f5dcee-c448-41d0-a348-483285523bbd
                    stepCounter: 25e05fdf-6237-4810-965a-adf12cfdd413
                transform: ""
          - columnReference:
              columnCounter: dd2b6d40-02ae-447f-8420-93ab62f332c5
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALESBYASIN_UNITSORDERED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 24395a35-e4a6-4d65-96d8-9d43941a41d1
                    stepCounter: 25e05fdf-6237-4810-965a-adf12cfdd413
                transform: ""
          - columnReference:
              columnCounter: db876c49-cb25-48ed-9e3e-d593bf400f6f
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(5,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TRAFFICBYASIN_BUYBOXPERCENTAGE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: a19f37e0-cc86-4bc5-a9ac-73ceaabda7fd
                    stepCounter: 25e05fdf-6237-4810-965a-adf12cfdd413
                transform: ""
          - columnReference:
              columnCounter: 6deefcf7-2b89-4da1-b82d-046d4f4ba847
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TRAFFICBYASIN_PAGEVIEWS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 906e2402-c1c8-4e28-aa92-b6a3e7c39ab3
                    stepCounter: 25e05fdf-6237-4810-965a-adf12cfdd413
                transform: ""
          - columnReference:
              columnCounter: e7e38ae2-db27-4cf7-9ef7-9964c0f1d069
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: TRAFFICBYASIN_SESSIONS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 240a06af-9a02-4e2a-a4c2-55f665295d0d
                    stepCounter: 25e05fdf-6237-4810-965a-adf12cfdd413
                transform: ""
          - columnReference:
              columnCounter: 6e95ef3e-40d2-4bf4-9e52-a991e73929ec
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: DESCRIPTION
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 4d8f5f21-f2ce-4f02-bd8d-833ba1acb755
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: a7e6e38f-561a-43ed-af51-a717e4e34f9e
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(20,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: COST
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 0a23294c-d2d4-4a45-9791-36b01dac81a6
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 2eec6efb-0b9f-482f-8149-0557631aa894
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(20,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: RETAILPRICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 967e644c-6a17-419d-b20c-0000659a4584
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 96f12650-c1d2-4ce3-8c9c-44b1c132847e
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(20,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SALEPRICE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: e6b724d5-0803-448b-932e-c4c6b654117b
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 794219ed-fe34-4001-82e0-1d632d5fb965
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: BRAND
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7e2d718a-bc8d-45c9-a54c-20c87d6b8449
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 26499736-c78a-4ed0-b91b-4ece1675c41d
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: PRODUCTLINE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 7381c728-3091-4fc4-bd4e-b01002ebcb51
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 136cae39-6bb6-412e-a3a6-4ddb1f63912f
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: AMAZONORDERID
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: d89324b6-9b40-4827-a1c8-39f567cea93c
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 25a7b32d-b917-46fe-9fd5-7d2184f66a07
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ITEMSHIPSTATUS
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: fbe9bf52-007f-48ab-9c3f-e513517d91d4
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: a7f3aebe-a6f6-4a54-8181-f0158981a05b
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ASIN
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 82dbd7bb-3dc0-4ec6-a452-1e218a711658
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 25b1cf94-9711-4305-b39c-eef0db172170
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: VARCHAR(16777216)
            description: ""
            hashColumns: []
            hashDetails: null
            name: SKU
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 40d56618-90d2-485e-a83e-a7d9e490379c
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 50bf28bf-d475-4c3f-9e9c-580908da01d9
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(38,0)
            description: ""
            hashColumns: []
            hashDetails: null
            name: QUANTITYORDERED
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 86adea80-c85b-4e4b-8519-bbf0ca430e6d
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - columnReference:
              columnCounter: 827ea180-b0cb-4dfd-9910-0f4cebc8cb8b
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            dataType: NUMBER(20,2)
            description: ""
            hashColumns: []
            hashDetails: null
            name: ITEMPRICEAMOUNT
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: 60163ffc-63d4-4007-b71d-c805061884ce
                    stepCounter: 5f5edcac-3a3e-4d2c-a385-528902b8e008
                transform: ""
          - acceptedValues:
              strictMatch: true
              values: []
            appliedColumnTests: {}
            columnReference:
              columnCounter: 71488382-8a6b-4c17-b077-5c198a1f43f0
              stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
            config: {}
            dataType: TIMESTAMP_NTZ(9)
            defaultValue: ""
            description: ""
            keyColumnType: None
            name: LINE_DATE
            nullable: true
            sourceColumnReferences:
              - columnReferences:
                  - columnCounter: "0"
                    stepCounter: "0"
                transform: ""
            systemColumnType: None
            transform: ""
        cteString: ""
        enabledColumnTestIDs: []
        sourceMapping:
          - aliases:
              STG_TB_ORDERSPROD_UNION: 5f5edcac-3a3e-4d2c-a385-528902b8e008
              STG_TB_STRAFF_PRODS_UNION: 25e05fdf-6237-4810-965a-adf12cfdd413
            customSQL:
              customSQL: |-
                {{ stage('Override Create SQL') }}
                CREATE OR REPLACE VIEW
                  "IMPACT_READ"."PUBLIC"."STG_TB_IMPACT2" (
                    "SALESBYASIN_TOTALORDERITEMS",
                    "SALESBYASIN_UNITSORDERED",
                    "TRAFFICBYASIN_BUYBOXPERCENTAGE",
                    "TRAFFICBYASIN_PAGEVIEWS",
                    "TRAFFICBYASIN_SESSIONS",
                    "DESCRIPTION",
                    "COST",
                    "RETAILPRICE",
                    "SALEPRICE",
                    "BRAND",
                    "PRODUCTLINE",
                    "AMAZONORDERID",
                    "ITEMSHIPSTATUS",
                    "ASIN",
                    "SKU",
                    "QUANTITYORDERED",
                    "ITEMPRICEAMOUNT",
                    "LINE_DATE"
                  ) AS
                SELECT DISTINCT
                  "STG_TB_STRAFF_PRODS_UNION"."SALESBYASIN_TOTALORDERITEMS" AS "SALESBYASIN_TOTALORDERITEMS",
                  "STG_TB_STRAFF_PRODS_UNION"."SALESBYASIN_UNITSORDERED" AS "SALESBYASIN_UNITSORDERED",
                  "STG_TB_STRAFF_PRODS_UNION"."TRAFFICBYASIN_BUYBOXPERCENTAGE" AS "TRAFFICBYASIN_BUYBOXPERCENTAGE",
                  "STG_TB_STRAFF_PRODS_UNION"."TRAFFICBYASIN_PAGEVIEWS" AS "TRAFFICBYASIN_PAGEVIEWS",
                  "STG_TB_STRAFF_PRODS_UNION"."TRAFFICBYASIN_SESSIONS" AS "TRAFFICBYASIN_SESSIONS",
                  IFF("STG_TB_ORDERSPROD_UNION"."DESCRIPTION" != NULL, "STG_TB_ORDERSPROD_UNION"."DESCRIPTION", "STG_TB_STRAFF_PRODS_UNION"."DESCRIPTION") AS "DESCRIPTION",
                  IFF("STG_TB_ORDERSPROD_UNION"."COST" != NULL, "STG_TB_ORDERSPROD_UNION"."COST", "STG_TB_STRAFF_PRODS_UNION"."COST") AS "COST",
                  IFF("STG_TB_ORDERSPROD_UNION"."RETAILPRICE" != NULL, "STG_TB_ORDERSPROD_UNION"."RETAILPRICE", "STG_TB_STRAFF_PRODS_UNION"."RETAILPRICE") AS "RETAILPRICE",
                  IFF("STG_TB_ORDERSPROD_UNION"."SALEPRICE" != NULL, "STG_TB_ORDERSPROD_UNION"."SALEPRICE", "STG_TB_STRAFF_PRODS_UNION"."SALEPRICE") AS "SALEPRICE",
                  IFF("STG_TB_ORDERSPROD_UNION"."BRAND" != NULL, "STG_TB_ORDERSPROD_UNION"."BRAND", "STG_TB_STRAFF_PRODS_UNION"."BRAND") AS "BRAND",
                  IFF("STG_TB_ORDERSPROD_UNION"."PRODUCTLINE" != NULL, "STG_TB_ORDERSPROD_UNION"."PRODUCTLINE", "STG_TB_STRAFF_PRODS_UNION"."PRODUCTLINE") AS "PRODUCTLINE",
                  "STG_TB_ORDERSPROD_UNION"."AMAZONORDERID" AS "AMAZONORDERID",
                  "STG_TB_ORDERSPROD_UNION"."ITEMSHIPSTATUS" AS "ITEMSHIPSTATUS",
                  IFF("STG_TB_ORDERSPROD_UNION"."ASIN" != NULL, "STG_TB_ORDERSPROD_UNION"."ASIN", "STG_TB_STRAFF_PRODS_UNION"."CHILDASIN") AS "ASIN",
                  "STG_TB_ORDERSPROD_UNION"."SKU" AS "SKU",
                  "STG_TB_ORDERSPROD_UNION"."QUANTITYORDERED" AS "QUANTITYORDERED",
                  "STG_TB_ORDERSPROD_UNION"."ITEMPRICEAMOUNT" AS "ITEMPRICEAMOUNT",
                  IFNULL(TO_TIMESTAMP(CONVERT_TIMEZONE('UTC', 'America/Los_Angeles', "STG_TB_ORDERSPROD_UNION"."PURCHASEDATE"::timestamp_ntz)), TO_TIMESTAMP(CONVERT_TIMEZONE('UTC', 'America/Los_Angeles', "STG_TB_STRAFF_PRODS_UNION"."DATE"::timestamp_ntz))) AS "LINE_DATE"
                FROM
                  "IMPACT_READ"."PUBLIC"."STG_TB_STRAFF_PRODS_UNION" "STG_TB_STRAFF_PRODS_UNION"
                  FULL JOIN "IMPACT_READ"."PUBLIC"."STG_TB_ORDERSPROD_UNION" "STG_TB_ORDERSPROD_UNION" ON "STG_TB_STRAFF_PRODS_UNION"."CHILDASIN" = "STG_TB_ORDERSPROD_UNION"."ASIN"
                  WHERE TO_DATE(CONVERT_TIMEZONE('UTC', 'America/Los_Angeles', "STG_TB_STRAFF_PRODS_UNION"."DATE"::timestamp_ntz)) = TO_DATE(CONVERT_TIMEZONE('UTC', 'America/Los_Angeles', "STG_TB_ORDERSPROD_UNION"."PURCHASEDATE"::timestamp_ntz))
            dependencies:
              - locationName: SAMPLE
                nodeName: STG_TB_ORDERSPROD_UNION
              - locationName: SAMPLE
                nodeName: STG_TB_STRAFF_PRODS_UNION
            join:
              joinCondition: |-
                FROM {{ ref('SAMPLE', 'STG_TB_STRAFF_PRODS_UNION') }} "STG_TB_STRAFF_PRODS_UNION"
                FULL JOIN {{ ref('SAMPLE', 'STG_TB_ORDERSPROD_UNION') }} "STG_TB_ORDERSPROD_UNION"
                ON "STG_TB_STRAFF_PRODS_UNION"."CHILDASIN" = "STG_TB_ORDERSPROD_UNION"."ASIN"
            name: STG_TB_IMPACT2
            noLinkRefs: []
      name: STG_TB_IMPACT2
      overrideSQL: true
      schema: ""
      sqlType: Stage
      type: sql
    stepCounter: 090daba6-9a5d-4654-af35-90cff8403382
